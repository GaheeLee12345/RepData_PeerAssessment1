##Read the data
setwd("C:/Users/gahee/Documents/2016_Unist/2016_2nd/R/week14")
  rawdata <- read.csv("activity.csv")
dat=aggregate(steps ~date, data=rawdata, sum, na.rm=TRUE)

##histogram 1
hist(dat$steps, breaks=20, main="Total Steps per Dat", xlab="Steps", ylab = "Frequency")

##what is mean total number of steps taken per day
steps_mean = mean(rawdata$steps, na.rm=TRUE)
steps_median = median(rawdata$steps, na.rm = TRUE)

print(paste("The mean steps per day is: ", steps_mean))
print(paste("The median steps per day is: ", steps_median))


##what is the average daily activity pattern
stepsdat = aggregate(steps ~ interval, data=rawdata,mean, na.rm=TRUE)
plot(stepsdat$interval, stepsdat$steps, type="l", main = "Average steps per Five minute interval", xlab="Interval No.", ylab="steps")

maxsteps = max(stepsdat$steps)
print(paste("The maximum number of steps in a five minute interval was: ", maxsteps))

##Imputing missing values
missingdat = sum(is.na(rawdata$steps))
print(paste("There are", missingdat, "missing data points."))

betterdat = rawdata
betterdat$steps[is.na(betterdat$steps)] = median(rawdata$steps, na.rm = "TRUE")
betterdataday = aggregate(steps ~ date, data=betterdat, sum, na.rm=TRUE)
hist(betterdataday$steps, breaks=20, main="Total steps per Day Adjusted Data", xlab="Steps", ylab="Frequency")

bsteps_mean = mean(betterdat$steps)
bsteps_median = median(betterdat$steps)
print(paste("The mean is: ", bsteps_mean))
print(paste("The median is: ", bsteps_median))


##are there differences in activity patterns between weekdays and weekends
betterdat$date = as.Date(betterdat$date)
betterdat$dayname = weekdays(betterdat$date)
betterdat$weekend = as.factor(ifelse(betterdat$dayname == "Saturday" | 
                                       betterdat$dayname == "Sunday", "weekend", "weekday"))
library(lattice)
plotdat = aggregate(steps ~ interval + weekend, betterdat, mean)
xyplot(steps~interval | factor(weekend), data=plotdat, aspect = 1/3, type = "l")

